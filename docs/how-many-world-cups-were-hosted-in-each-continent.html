<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.2 How many world cups were hosted in each continent? | Fifa worldcup 2022</title>
  <meta name="description" content="1.2 How many world cups were hosted in each continent? | Fifa worldcup 2022" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="1.2 How many world cups were hosted in each continent? | Fifa worldcup 2022" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.2 How many world cups were hosted in each continent? | Fifa worldcup 2022" />
  
  
  

<meta name="author" content="Mohamed R.Shoeb" />


<meta name="date" content="2022-12-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="where-and-how-can-we-get-the-data.html"/>
<link rel="next" href="what-is-the-timeline-of-hosting-the-world-cup.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">FIFA world cup 2022</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-read-this-book"><i class="fa fa-check"></i>Why read this book?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#structure-of-the-book"><i class="fa fa-check"></i>Structure of the book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-read-this-book"><i class="fa fa-check"></i>How to read this book?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the author</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="history-of-hosting-fifa-world-cup.html"><a href="history-of-hosting-fifa-world-cup.html"><i class="fa fa-check"></i><b>1</b> History of hosting FIFA World Cup</a>
<ul>
<li class="chapter" data-level="1.1" data-path="where-and-how-can-we-get-the-data.html"><a href="where-and-how-can-we-get-the-data.html"><i class="fa fa-check"></i><b>1.1</b> Where and how can we get the data?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="where-and-how-can-we-get-the-data.html"><a href="where-and-how-can-we-get-the-data.html#data-retrieval"><i class="fa fa-check"></i><b>1.1.1</b> Data retrieval</a></li>
<li class="chapter" data-level="1.1.2" data-path="where-and-how-can-we-get-the-data.html"><a href="where-and-how-can-we-get-the-data.html#data-quality-control"><i class="fa fa-check"></i><b>1.1.2</b> Data quality control</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="how-many-world-cups-were-hosted-in-each-continent.html"><a href="how-many-world-cups-were-hosted-in-each-continent.html"><i class="fa fa-check"></i><b>1.2</b> How many world cups were hosted in each continent?</a></li>
<li class="chapter" data-level="1.3" data-path="what-is-the-timeline-of-hosting-the-world-cup.html"><a href="what-is-the-timeline-of-hosting-the-world-cup.html"><i class="fa fa-check"></i><b>1.3</b> What is the timeline of hosting the world cup?</a></li>
<li class="chapter" data-level="1.4" data-path="what-is-the-history-of-bidding-for-world-cup.html"><a href="what-is-the-history-of-bidding-for-world-cup.html"><i class="fa fa-check"></i><b>1.4</b> What is the history of bidding for world cup?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cost-of-hosting-world-cup.html"><a href="cost-of-hosting-world-cup.html"><i class="fa fa-check"></i><b>2</b> Cost of hosting world cup</a></li>
<li class="chapter" data-level="3" data-path="teams-performance.html"><a href="teams-performance.html"><i class="fa fa-check"></i><b>3</b> Teams’ performance</a></li>
<li class="chapter" data-level="4" data-path="players-performance.html"><a href="players-performance.html"><i class="fa fa-check"></i><b>4</b> Players’ performance</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fifa worldcup 2022</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="how-many-world-cups-were-hosted-in-each-continent" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> How many world cups were hosted in each continent?<a href="how-many-world-cups-were-hosted-in-each-continent.html#how-many-world-cups-were-hosted-in-each-continent" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before embarking on our colorful journey of data visualization, let’s define a caption that credits the source of the data and the analysis.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb39-1" aria-hidden="true" tabindex="-1"></a>caption_cdc <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;Data source: {url}</span><span class="sc">\n</span><span class="st">@Cairo Data Science Club&quot;</span>)</span>
<span id="cb39-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_update</span>(<span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>))</span></code></pre></div>
<p>We will exclude the dates in which the championship was cancelled because of Warld War II</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb40-1" aria-hidden="true" tabindex="-1"></a>df_host1 <span class="ot">&lt;-</span> tbls_lst<span class="sc">$</span>list_of_hosts <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(continent, <span class="st">&quot;Cancelled&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(host_year) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(),</span>
<span id="cb40-5"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb40-5" aria-hidden="true" tabindex="-1"></a>                   <span class="sc">~</span> <span class="fu">paste</span>(<span class="fu">unique</span>(.x),<span class="at">collapse =</span> <span class="st">&quot;, &quot;</span>)</span>
<span id="cb40-6"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb40-6" aria-hidden="true" tabindex="-1"></a>                   )</span>
<span id="cb40-7"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb40-7" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">%&gt;%</span></span>
<span id="cb40-8"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb40-9"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span></code></pre></div>
<p>Let’s look at a basic plot of the data</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb41-1" aria-hidden="true" tabindex="-1"></a>(bar_host_plt <span class="ot">&lt;-</span> df_host1 <span class="sc">%&gt;%</span> </span>
<span id="cb41-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(continent))<span class="sc">+</span></span>
<span id="cb41-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>())</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-19-1.png" width="100%" height="100%" /></p>
<p>This doesn’t look pretty. Let’s make it more attractive! First, let’s add a some colors.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Assign colors to each continent</span></span>
<span id="cb42-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb42-2" aria-hidden="true" tabindex="-1"></a>conti_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Europe =</span> <span class="st">&quot;#1f78b4&quot;</span>,</span>
<span id="cb42-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb42-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">Asia =</span> <span class="st">&quot;#6a3d9a&quot;</span>,</span>
<span id="cb42-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb42-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">`</span><span class="at">South America</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;#ffff99&quot;</span>,</span>
<span id="cb42-5"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb42-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">`</span><span class="at">North America</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;#33a02c&quot;</span>,</span>
<span id="cb42-6"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb42-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">Africa =</span> <span class="st">&quot;#ff7f00&quot;</span>)</span>
<span id="cb42-7"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co">#show colors in the plot</span></span>
<span id="cb42-8"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb42-8" aria-hidden="true" tabindex="-1"></a>(bar_host_plt <span class="ot">&lt;-</span> bar_host_plt <span class="sc">+</span></span>
<span id="cb42-9"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> continent))<span class="sc">+</span></span>
<span id="cb42-10"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> conti_cols)<span class="sc">+</span></span>
<span id="cb42-11"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> conti_cols))</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-20-1.png" width="100%" height="100%" /></p>
<p>Second, let’s add some text and remove the legend since it doesn’t add to the plot.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb43-1" aria-hidden="true" tabindex="-1"></a>(bar_host_plt <span class="ot">&lt;-</span> bar_host_plt <span class="sc">+</span></span>
<span id="cb43-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb43-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;History of hosting world cup&quot;</span>,</span>
<span id="cb43-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb43-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Number of hosted world cups and hosting countries per continents&quot;</span>,</span>
<span id="cb43-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb43-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> caption_cdc))</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-21-1.png" width="100%" height="100%" /></p>
<p>Next, I think we can get rid off the axis and label each bar with important information.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-1" aria-hidden="true" tabindex="-1"></a>df_host2 <span class="ot">&lt;-</span> df_host1 <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span> </span>
<span id="cb44-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())<span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb44-5"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(n) <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">continent =</span> <span class="fu">factor</span>(continent, <span class="at">levels =</span> <span class="fu">unique</span>(continent)))</span>
<span id="cb44-7"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-8" aria-hidden="true" tabindex="-1"></a>df_host_3 <span class="ot">&lt;-</span> df_host2 <span class="sc">%&gt;%</span> </span>
<span id="cb44-9"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">cont_n =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;{continent}</span><span class="sc">\n</span><span class="st">(n = {n})&quot;</span>))</span>
<span id="cb44-10"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-10" aria-hidden="true" tabindex="-1"></a>(bar_host_plt <span class="ot">&lt;-</span> df_host2 <span class="sc">%&gt;%</span> </span>
<span id="cb44-11"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(continent, n))<span class="sc">+</span></span>
<span id="cb44-12"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">color =</span> continent), <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>,  <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb44-13"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> continent), <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb44-14"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> df_host_3,</span>
<span id="cb44-15"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> cont_n), <span class="at">size =</span> <span class="dv">5</span>,<span class="at">nudge_y =</span> <span class="fl">0.6</span>)<span class="sc">+</span></span>
<span id="cb44-16"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;History of hosting world cup&quot;</span>,</span>
<span id="cb44-17"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Number of hosted world cups and hosting countries per continents&quot;</span>,</span>
<span id="cb44-18"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> caption_cdc)<span class="sc">+</span></span>
<span id="cb44-19"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> conti_cols)<span class="sc">+</span></span>
<span id="cb44-20"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> conti_cols)<span class="sc">+</span></span>
<span id="cb44-21"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb44-22"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb44-23"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb44-24"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>()))</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-22-1.png" width="100%" height="100%" /></p>
<p>These long bars, there’s something about them. Something … empty. I got an idea! Why not fill them with the names of the hosting countries?! That would look awesome!</p>
<p>The goal is stack countries’ names in an equidistant fashion within each bar. To do this, we divide the bar, which indicates the number of hosted world cups, by the number of hosting countries. This would simply partition the bar into equally-sized parts equal to the number of hosting countries. Finally, to get the location of countries within the bar, we compute the cumulative sum of the size of these parts.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb45-1" aria-hidden="true" tabindex="-1"></a>df_txt_bar <span class="ot">&lt;-</span> df_host1 <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb45-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">group_by</span>(continent, country_name) <span class="sc">%&gt;%</span> </span>
<span id="cb45-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb45-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">summarise</span>(<span class="at">n_host =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="co"># number of hosted world cups per country</span></span>
<span id="cb45-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb45-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span> </span>
<span id="cb45-5"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb45-5" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">n_countries =</span> <span class="fu">n</span>(), <span class="co">#number of hosting countries </span></span>
<span id="cb45-6"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb45-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">n_cont =</span> <span class="fu">sum</span>(n_host), <span class="co">#number of hosted world cups per continent (height of the bar)</span></span>
<span id="cb45-7"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb45-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prop =</span> n_cont<span class="sc">/</span>(n_countries<span class="sc">+</span><span class="dv">1</span>), <span class="co"># divides the bar height by the number of countries</span></span>
<span id="cb45-8"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb45-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">cum_prop =</span> <span class="fu">cumsum</span>(prop) <span class="co">#stack countries&#39; names within the bar</span></span>
<span id="cb45-9"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb45-9" aria-hidden="true" tabindex="-1"></a>                     )<span class="sc">%&gt;%</span></span>
<span id="cb45-10"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb45-10" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb45-11"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb45-11" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">country_name =</span> <span class="fu">ifelse</span>(n_host <span class="sc">&gt;</span><span class="dv">1</span> , glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;{country_name} x {n_host}&quot;</span>), country_name) <span class="co"># indicate the number of times a country hosted the world cup</span></span>
<span id="cb45-12"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb45-12" aria-hidden="true" tabindex="-1"></a>                     )</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;continent&#39;. You can override using the
## `.groups` argument.</code></pre>
<p>Let’s fill these empty bars with the names of the hosting countries</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb47-1" aria-hidden="true" tabindex="-1"></a>bar_host_plt <span class="ot">&lt;-</span> bar_host_plt <span class="sc">+</span></span>
<span id="cb47-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> df_txt_bar,</span>
<span id="cb47-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb47-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> cum_prop, <span class="at">label =</span> country_name),</span>
<span id="cb47-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb47-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>This worked nicely! I will finalize this plot by adding an image of world cup in the background! Yes, you can do this in R. I need to mention that I got the code for the function <code>trasparent</code> below from an answer <a href="#https://stackoverflow.com/questions/60820565/is-there-a-way-to-add-an-alpha-value-within-geom-image-in-ggplot">here</a>.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#get image</span></span>
<span id="cb48-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-2" aria-hidden="true" tabindex="-1"></a>wc_img <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;images/wc12.png&quot;</span>)</span>
<span id="cb48-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co">#define function to control transparency and set to 0.2</span></span>
<span id="cb48-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-5" aria-hidden="true" tabindex="-1"></a>transparent <span class="ot">&lt;-</span> <span class="cf">function</span>(img) {</span>
<span id="cb48-6"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-6" aria-hidden="true" tabindex="-1"></a>  magick<span class="sc">::</span><span class="fu">image_fx</span>(img, <span class="at">expression =</span> <span class="st">&quot;0.2*a&quot;</span>, <span class="at">channel =</span> <span class="st">&quot;alpha&quot;</span>)</span>
<span id="cb48-7"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-8"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co">#add the image in the background</span></span>
<span id="cb48-9"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-9" aria-hidden="true" tabindex="-1"></a>bar_host_plt<span class="sc">+</span></span>
<span id="cb48-10"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-10" aria-hidden="true" tabindex="-1"></a>  ggimage<span class="sc">::</span><span class="fu">geom_image</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">7.5</span>),</span>
<span id="cb48-11"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-11" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">aes</span>(x,y),</span>
<span id="cb48-12"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">image =</span> wc_img,<span class="at">image_fun =</span> transparent,</span>
<span id="cb48-13"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-25-1.png" width="100%" height="100%" /></p>
<p>Isn’t that nice?!</p>
<p><img src="https://media.giphy.com/media/UQsYRkg6DLbJ6eIrYV/giphy.gif" /></p>
<p>Let’s add some geographical-context to these results by throwing the data on the world map and see how it would look like.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#get map of the world</span></span>
<span id="cb49-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb49-2" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">scale =</span> <span class="st">&quot;medium&quot;</span>, <span class="at">returnclass =</span> <span class="st">&quot;sf&quot;</span>)</span>
<span id="cb49-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co">#and map of separate host countries</span></span>
<span id="cb49-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb49-4" aria-hidden="true" tabindex="-1"></a>host_iso2 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(<span class="fu">unique</span>(tbls_lst<span class="sc">$</span>list_of_hosts<span class="sc">$</span>country_code))</span>
<span id="cb49-5"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb49-5" aria-hidden="true" tabindex="-1"></a>wcp_hosts <span class="ot">&lt;-</span> <span class="fu">gisco_get_countries</span>(<span class="at">country =</span> host_iso2,</span>
<span id="cb49-6"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb49-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">epsg =</span> <span class="dv">3857</span><span class="co"># Pseudo-Mercator projection</span></span>
<span id="cb49-7"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb49-7" aria-hidden="true" tabindex="-1"></a>                                 )</span>
<span id="cb49-8"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb49-8" aria-hidden="true" tabindex="-1"></a>wcp_hosts<span class="sc">$</span>iso2 <span class="ot">&lt;-</span> host_iso2</span></code></pre></div>
<p>Plotting base map of the world using ggplot.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base map of the world</span></span>
<span id="cb50-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb50-2" aria-hidden="true" tabindex="-1"></a>(plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(world) <span class="sc">+</span></span>
<span id="cb50-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">fill =</span> <span class="st">&quot;grey90&quot;</span>) <span class="sc">+</span></span>
<span id="cb50-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-5"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>)))</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-27-1.png" width="100%" height="100%" /></p>
<p>Additionally, let’s make the map extra flashy by filling hosting countries with their maps.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get flags form this repo</span></span>
<span id="cb51-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb51-2" aria-hidden="true" tabindex="-1"></a>flagrepo <span class="ot">&lt;-</span> <span class="st">&quot;https://raw.githubusercontent.com/hjnilsson/country-flags/master/png250px/&quot;</span></span></code></pre></div>
<p>Finally, we’ll download the flags</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop and add</span></span>
<span id="cb52-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (iso <span class="cf">in</span> host_iso2) {</span>
<span id="cb52-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Download pic and plot</span></span>
<span id="cb52-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb52-4" aria-hidden="true" tabindex="-1"></a>  imgurl <span class="ot">&lt;-</span> <span class="fu">paste0</span>(flagrepo, <span class="fu">tolower</span>(iso), <span class="st">&quot;.png&quot;</span>)</span>
<span id="cb52-5"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb52-5" aria-hidden="true" tabindex="-1"></a>  tmpfile <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">&quot;.png&quot;</span>)</span>
<span id="cb52-6"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(imgurl, tmpfile, <span class="at">quiet =</span> <span class="cn">TRUE</span>, <span class="at">mode =</span> <span class="st">&quot;wb&quot;</span>)</span>
<span id="cb52-7"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb52-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-8"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Raster</span></span>
<span id="cb52-9"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb52-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> wcp_hosts <span class="sc">%&gt;%</span> <span class="fu">filter</span>(iso2 <span class="sc">==</span> iso)</span>
<span id="cb52-10"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb52-10" aria-hidden="true" tabindex="-1"></a>  x_rast <span class="ot">&lt;-</span> <span class="fu">rasterpic_img</span>(x, tmpfile, <span class="at">crop =</span> <span class="cn">TRUE</span>, <span class="at">mask =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-11"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb52-11" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> plot <span class="sc">+</span> <span class="fu">layer_spatial</span>(x_rast)</span>
<span id="cb52-12"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb52-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>and add them to world map</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-1" aria-hidden="true" tabindex="-1"></a>plot <span class="sc">+</span></span>
<span id="cb53-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> wcp_hosts, <span class="at">fill =</span> <span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb53-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;World map of FIFA world cup hosts&quot;</span>)</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-30-1.png" width="100%" height="100%" /></p>
<p>I’m very happy with the end result!</p>
<p><img src="https://media.giphy.com/media/jdBJkDYMphKaf89OTl/giphy.gif" /><br />
</p>
<p>Have a look at this <a href="https://dieghernan.github.io/202201_maps-flags/">excellent blog</a> for more details on adding flags to maps This is where I got to know and learn this trick.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="where-and-how-can-we-get-the-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="what-is-the-timeline-of-hosting-the-world-cup.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Cairo-Data-Science-Club-CDC/Fifa-worldcup-2022/edit/main/01-hosting_history.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
