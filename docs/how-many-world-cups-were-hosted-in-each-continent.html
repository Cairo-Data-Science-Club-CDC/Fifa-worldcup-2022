<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.2 How many world cups were hosted in each continent? | Fifa worldcup 2022</title>
  <meta name="description" content="1.2 How many world cups were hosted in each continent? | Fifa worldcup 2022" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="1.2 How many world cups were hosted in each continent? | Fifa worldcup 2022" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.2 How many world cups were hosted in each continent? | Fifa worldcup 2022" />
  
  
  

<meta name="author" content="Mohamed R.Shoeb" />


<meta name="date" content="2022-12-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="where-and-how-can-we-get-the-data.html"/>
<link rel="next" href="what-is-the-timeline-of-hosting-the-world-cup.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">FIFA world cup 2022</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-read-this-book"><i class="fa fa-check"></i>Why read this book?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#structure-of-the-book"><i class="fa fa-check"></i>Structure of the book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-read-this-book"><i class="fa fa-check"></i>How to read this book?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the author</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="history-of-hosting-fifa-world-cup.html"><a href="history-of-hosting-fifa-world-cup.html"><i class="fa fa-check"></i><b>1</b> History of hosting FIFA World Cup</a>
<ul>
<li class="chapter" data-level="1.1" data-path="where-and-how-can-we-get-the-data.html"><a href="where-and-how-can-we-get-the-data.html"><i class="fa fa-check"></i><b>1.1</b> Where and how can we get the data?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="where-and-how-can-we-get-the-data.html"><a href="where-and-how-can-we-get-the-data.html#data-retrieval"><i class="fa fa-check"></i><b>1.1.1</b> Data retrieval</a></li>
<li class="chapter" data-level="1.1.2" data-path="where-and-how-can-we-get-the-data.html"><a href="where-and-how-can-we-get-the-data.html#data-quality-control"><i class="fa fa-check"></i><b>1.1.2</b> Data quality control</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="how-many-world-cups-were-hosted-in-each-continent.html"><a href="how-many-world-cups-were-hosted-in-each-continent.html"><i class="fa fa-check"></i><b>1.2</b> How many world cups were hosted in each continent?</a></li>
<li class="chapter" data-level="1.3" data-path="what-is-the-timeline-of-hosting-the-world-cup.html"><a href="what-is-the-timeline-of-hosting-the-world-cup.html"><i class="fa fa-check"></i><b>1.3</b> What is the timeline of hosting the world cup?</a></li>
<li class="chapter" data-level="1.4" data-path="what-is-the-history-of-bidding-for-world-cup.html"><a href="what-is-the-history-of-bidding-for-world-cup.html"><i class="fa fa-check"></i><b>1.4</b> What is the history of bidding for world cup?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cost-of-hosting-world-cup.html"><a href="cost-of-hosting-world-cup.html"><i class="fa fa-check"></i><b>2</b> Cost of hosting world cup</a></li>
<li class="chapter" data-level="3" data-path="teams-performance.html"><a href="teams-performance.html"><i class="fa fa-check"></i><b>3</b> Teams’ performance</a></li>
<li class="chapter" data-level="4" data-path="players-performance.html"><a href="players-performance.html"><i class="fa fa-check"></i><b>4</b> Players’ performance</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fifa worldcup 2022</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="how-many-world-cups-were-hosted-in-each-continent" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> How many world cups were hosted in each continent?<a href="how-many-world-cups-were-hosted-in-each-continent.html#how-many-world-cups-were-hosted-in-each-continent" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before embarking on our colorful journey of data visualization, let’s define a caption that credits the source of the data and the analysis.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb39-1" aria-hidden="true" tabindex="-1"></a>caption_cdc <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;Data source: {url}</span><span class="sc">\n</span><span class="st">@Cairo Data Science Club&quot;</span>)</span>
<span id="cb39-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_update</span>(<span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>))</span></code></pre></div>
<p>We’ll start by having a quick look at the data.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb40-1" aria-hidden="true" tabindex="-1"></a>gt<span class="sc">::</span><span class="fu">gt</span>(<span class="fu">head</span>(tbls_lst<span class="sc">$</span>list_of_hosts))</span></code></pre></div>
<div id="rmwebwhmmf" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#rmwebwhmmf .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rmwebwhmmf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rmwebwhmmf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rmwebwhmmf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rmwebwhmmf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rmwebwhmmf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rmwebwhmmf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rmwebwhmmf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rmwebwhmmf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rmwebwhmmf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rmwebwhmmf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rmwebwhmmf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#rmwebwhmmf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rmwebwhmmf .gt_from_md > :first-child {
  margin-top: 0;
}

#rmwebwhmmf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rmwebwhmmf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rmwebwhmmf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rmwebwhmmf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rmwebwhmmf .gt_row_group_first td {
  border-top-width: 2px;
}

#rmwebwhmmf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rmwebwhmmf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rmwebwhmmf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rmwebwhmmf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rmwebwhmmf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rmwebwhmmf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rmwebwhmmf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rmwebwhmmf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rmwebwhmmf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rmwebwhmmf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rmwebwhmmf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rmwebwhmmf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rmwebwhmmf .gt_left {
  text-align: left;
}

#rmwebwhmmf .gt_center {
  text-align: center;
}

#rmwebwhmmf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rmwebwhmmf .gt_font_normal {
  font-weight: normal;
}

#rmwebwhmmf .gt_font_bold {
  font-weight: bold;
}

#rmwebwhmmf .gt_font_italic {
  font-style: italic;
}

#rmwebwhmmf .gt_super {
  font-size: 65%;
}

#rmwebwhmmf .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#rmwebwhmmf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rmwebwhmmf .gt_indent_1 {
  text-indent: 5px;
}

#rmwebwhmmf .gt_indent_2 {
  text-indent: 10px;
}

#rmwebwhmmf .gt_indent_3 {
  text-indent: 15px;
}

#rmwebwhmmf .gt_indent_4 {
  text-indent: 20px;
}

#rmwebwhmmf .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">host_year</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col">country_name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col">continent</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col">country_code</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">1930</td>
<td class="gt_row gt_left">Uruguay</td>
<td class="gt_row gt_left">South America</td>
<td class="gt_row gt_left">UY</td></tr>
    <tr><td class="gt_row gt_right">1934</td>
<td class="gt_row gt_left">Italy</td>
<td class="gt_row gt_left">Europe</td>
<td class="gt_row gt_left">IT</td></tr>
    <tr><td class="gt_row gt_right">1938</td>
<td class="gt_row gt_left">France</td>
<td class="gt_row gt_left">Europe</td>
<td class="gt_row gt_left">FR</td></tr>
    <tr><td class="gt_row gt_right">1942</td>
<td class="gt_row gt_left">Cancelled because of World War II</td>
<td class="gt_row gt_left">Cancelled because of World War II</td>
<td class="gt_row gt_left">NA</td></tr>
    <tr><td class="gt_row gt_right">1946</td>
<td class="gt_row gt_left">Cancelled because of World War II</td>
<td class="gt_row gt_left">Cancelled because of World War II</td>
<td class="gt_row gt_left">NA</td></tr>
    <tr><td class="gt_row gt_right">1950</td>
<td class="gt_row gt_left">Brazil</td>
<td class="gt_row gt_left">South America</td>
<td class="gt_row gt_left">BR</td></tr>
  </tbody>
  
  
</table>
</div>
<p>The table shows individual hosting countries of all world cups. But more than one country can cohost the same championship. What we need is a table of cohosts per world cup. To data that, we’ll start by excluding the dates in which the championship was cancelled because of Warld War II and combine cohosts of the same year.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb41-1" aria-hidden="true" tabindex="-1"></a>df_host1 <span class="ot">&lt;-</span> tbls_lst<span class="sc">$</span>list_of_hosts <span class="sc">%&gt;%</span> </span>
<span id="cb41-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(continent, <span class="st">&quot;Cancelled&quot;</span>)) <span class="sc">%&gt;%</span> <span class="co">#exclude cancelled events</span></span>
<span id="cb41-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(host_year) <span class="sc">%&gt;%</span> </span>
<span id="cb41-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(),</span>
<span id="cb41-5"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb41-5" aria-hidden="true" tabindex="-1"></a>                   <span class="sc">~</span> <span class="fu">paste</span>(<span class="fu">unique</span>(.x),<span class="at">collapse =</span> <span class="st">&quot;, &quot;</span>) <span class="co">#combine cohosts</span></span>
<span id="cb41-6"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb41-6" aria-hidden="true" tabindex="-1"></a>                   )</span>
<span id="cb41-7"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb41-7" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">%&gt;%</span></span>
<span id="cb41-8"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb41-9"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb41-10"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb41-11" aria-hidden="true" tabindex="-1"></a>gt<span class="sc">::</span><span class="fu">gt</span>(df_host1)</span></code></pre></div>
<div id="xvgchipien" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#xvgchipien .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xvgchipien .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xvgchipien .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xvgchipien .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xvgchipien .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xvgchipien .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xvgchipien .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xvgchipien .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xvgchipien .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xvgchipien .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xvgchipien .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xvgchipien .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#xvgchipien .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xvgchipien .gt_from_md > :first-child {
  margin-top: 0;
}

#xvgchipien .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xvgchipien .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xvgchipien .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xvgchipien .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xvgchipien .gt_row_group_first td {
  border-top-width: 2px;
}

#xvgchipien .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xvgchipien .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xvgchipien .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xvgchipien .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xvgchipien .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xvgchipien .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xvgchipien .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xvgchipien .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xvgchipien .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xvgchipien .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xvgchipien .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xvgchipien .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xvgchipien .gt_left {
  text-align: left;
}

#xvgchipien .gt_center {
  text-align: center;
}

#xvgchipien .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xvgchipien .gt_font_normal {
  font-weight: normal;
}

#xvgchipien .gt_font_bold {
  font-weight: bold;
}

#xvgchipien .gt_font_italic {
  font-style: italic;
}

#xvgchipien .gt_super {
  font-size: 65%;
}

#xvgchipien .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#xvgchipien .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xvgchipien .gt_indent_1 {
  text-indent: 5px;
}

#xvgchipien .gt_indent_2 {
  text-indent: 10px;
}

#xvgchipien .gt_indent_3 {
  text-indent: 15px;
}

#xvgchipien .gt_indent_4 {
  text-indent: 20px;
}

#xvgchipien .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col">host_year</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col">country_name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col">continent</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col">country_code</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">1930</td>
<td class="gt_row gt_left">Uruguay</td>
<td class="gt_row gt_left">South America</td>
<td class="gt_row gt_left">UY</td></tr>
    <tr><td class="gt_row gt_right">1934</td>
<td class="gt_row gt_left">Italy</td>
<td class="gt_row gt_left">Europe</td>
<td class="gt_row gt_left">IT</td></tr>
    <tr><td class="gt_row gt_right">1938</td>
<td class="gt_row gt_left">France</td>
<td class="gt_row gt_left">Europe</td>
<td class="gt_row gt_left">FR</td></tr>
    <tr><td class="gt_row gt_right">1950</td>
<td class="gt_row gt_left">Brazil</td>
<td class="gt_row gt_left">South America</td>
<td class="gt_row gt_left">BR</td></tr>
    <tr><td class="gt_row gt_right">1954</td>
<td class="gt_row gt_left">Switzerland</td>
<td class="gt_row gt_left">Europe</td>
<td class="gt_row gt_left">CH</td></tr>
    <tr><td class="gt_row gt_right">1958</td>
<td class="gt_row gt_left">Sweden</td>
<td class="gt_row gt_left">Europe</td>
<td class="gt_row gt_left">SE</td></tr>
    <tr><td class="gt_row gt_right">1962</td>
<td class="gt_row gt_left">Chile</td>
<td class="gt_row gt_left">South America</td>
<td class="gt_row gt_left">CL</td></tr>
    <tr><td class="gt_row gt_right">1966</td>
<td class="gt_row gt_left">England</td>
<td class="gt_row gt_left">Europe</td>
<td class="gt_row gt_left">NA</td></tr>
    <tr><td class="gt_row gt_right">1970</td>
<td class="gt_row gt_left">Mexico</td>
<td class="gt_row gt_left">North America</td>
<td class="gt_row gt_left">MX</td></tr>
    <tr><td class="gt_row gt_right">1974</td>
<td class="gt_row gt_left">Germany</td>
<td class="gt_row gt_left">Europe</td>
<td class="gt_row gt_left">DE</td></tr>
    <tr><td class="gt_row gt_right">1978</td>
<td class="gt_row gt_left">Argentina</td>
<td class="gt_row gt_left">South America</td>
<td class="gt_row gt_left">AR</td></tr>
    <tr><td class="gt_row gt_right">1982</td>
<td class="gt_row gt_left">Spain</td>
<td class="gt_row gt_left">Europe</td>
<td class="gt_row gt_left">ES</td></tr>
    <tr><td class="gt_row gt_right">1986</td>
<td class="gt_row gt_left">Mexico</td>
<td class="gt_row gt_left">North America</td>
<td class="gt_row gt_left">MX</td></tr>
    <tr><td class="gt_row gt_right">1990</td>
<td class="gt_row gt_left">Italy</td>
<td class="gt_row gt_left">Europe</td>
<td class="gt_row gt_left">IT</td></tr>
    <tr><td class="gt_row gt_right">1994</td>
<td class="gt_row gt_left">United States</td>
<td class="gt_row gt_left">North America</td>
<td class="gt_row gt_left">US</td></tr>
    <tr><td class="gt_row gt_right">1998</td>
<td class="gt_row gt_left">France</td>
<td class="gt_row gt_left">Europe</td>
<td class="gt_row gt_left">FR</td></tr>
    <tr><td class="gt_row gt_right">2002</td>
<td class="gt_row gt_left">Japan, South Korea</td>
<td class="gt_row gt_left">Asia</td>
<td class="gt_row gt_left">JP, KR</td></tr>
    <tr><td class="gt_row gt_right">2006</td>
<td class="gt_row gt_left">Germany</td>
<td class="gt_row gt_left">Europe</td>
<td class="gt_row gt_left">DE</td></tr>
    <tr><td class="gt_row gt_right">2010</td>
<td class="gt_row gt_left">South Africa</td>
<td class="gt_row gt_left">Africa</td>
<td class="gt_row gt_left">ZA</td></tr>
    <tr><td class="gt_row gt_right">2014</td>
<td class="gt_row gt_left">Brazil</td>
<td class="gt_row gt_left">South America</td>
<td class="gt_row gt_left">BR</td></tr>
    <tr><td class="gt_row gt_right">2018</td>
<td class="gt_row gt_left">Russia</td>
<td class="gt_row gt_left">Europe</td>
<td class="gt_row gt_left">RU</td></tr>
    <tr><td class="gt_row gt_right">2022</td>
<td class="gt_row gt_left">Qatar</td>
<td class="gt_row gt_left">Asia</td>
<td class="gt_row gt_left">QA</td></tr>
    <tr><td class="gt_row gt_right">2026</td>
<td class="gt_row gt_left">Canada, Mexico, United States</td>
<td class="gt_row gt_left">North America</td>
<td class="gt_row gt_left">CA, MX, US</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Let’s look at a basic bar plot of the data</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb42-1" aria-hidden="true" tabindex="-1"></a>(bar_host_plt <span class="ot">&lt;-</span> df_host1 <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(continent))<span class="sc">+</span></span>
<span id="cb42-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>())</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-20-1.png" width="100%" height="100%" /></p>
<p>This doesn’t look pretty. Let’s make it more attractive! First, let’s add a some colors.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Assign colors to each continent</span></span>
<span id="cb43-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb43-2" aria-hidden="true" tabindex="-1"></a>conti_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Europe =</span> <span class="st">&quot;#1f78b4&quot;</span>,</span>
<span id="cb43-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb43-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">Asia =</span> <span class="st">&quot;#6a3d9a&quot;</span>,</span>
<span id="cb43-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb43-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">`</span><span class="at">South America</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;#ffff99&quot;</span>,</span>
<span id="cb43-5"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb43-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">`</span><span class="at">North America</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;#33a02c&quot;</span>,</span>
<span id="cb43-6"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb43-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">Africa =</span> <span class="st">&quot;#ff7f00&quot;</span>)</span></code></pre></div>
<p>… and have another look on the plot.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#show colors in the plot</span></span>
<span id="cb44-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-2" aria-hidden="true" tabindex="-1"></a>(bar_host_plt <span class="ot">&lt;-</span> bar_host_plt <span class="sc">+</span></span>
<span id="cb44-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> continent))<span class="sc">+</span></span>
<span id="cb44-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> conti_cols)<span class="sc">+</span></span>
<span id="cb44-5"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> conti_cols))</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-22-1.png" width="100%" height="100%" /></p>
<p>Now let’s add some text to give context to the visualized data.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb45-1" aria-hidden="true" tabindex="-1"></a>(bar_host_plt <span class="ot">&lt;-</span> bar_host_plt <span class="sc">+</span></span>
<span id="cb45-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;History of hosting world cup&quot;</span>,</span>
<span id="cb45-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb45-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Number of hosted world cups and hosting countries per continents&quot;</span>,</span>
<span id="cb45-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb45-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> caption_cdc))</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-23-1.png" width="100%" height="100%" /></p>
<p>Next, let’s order continents by number of hosted games</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb46-1" aria-hidden="true" tabindex="-1"></a>df_host2 <span class="ot">&lt;-</span> df_host1 <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())<span class="sc">%&gt;%</span> <span class="co">#number of world cups per continent</span></span>
<span id="cb46-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb46-5"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(n) <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">continent =</span> <span class="fu">factor</span>(continent, <span class="at">levels =</span> <span class="fu">unique</span>(continent))) <span class="co">#set continents order based on number of hosts</span></span></code></pre></div>
<p>and add a vector of characters showing both the name of continent and number of hosted cups to label each bar.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb47-1" aria-hidden="true" tabindex="-1"></a>df_host_3 <span class="ot">&lt;-</span> df_host2 <span class="sc">%&gt;%</span> </span>
<span id="cb47-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb47-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">cont_n =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;{continent} (n = {n})&quot;</span>))</span></code></pre></div>
<p>Let’s put things together and have a look on the updated plot. Also, I think we can safely remove the axis and rather add the labels from the previous step on top of each bar.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-1" aria-hidden="true" tabindex="-1"></a>(bar_host_plt <span class="ot">&lt;-</span> df_host2 <span class="sc">%&gt;%</span> </span>
<span id="cb48-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(continent, n))<span class="sc">+</span></span>
<span id="cb48-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#add a layer of bars with white fill and colored borders</span></span>
<span id="cb48-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">color =</span> continent),</span>
<span id="cb48-5"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb48-6"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb48-7"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb48-8"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#then add another layer of bars with transparent fill</span></span>
<span id="cb48-9"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> continent),</span>
<span id="cb48-10"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.4</span>,</span>
<span id="cb48-11"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.legend =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb48-12"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#add the text labels on top of the bars</span></span>
<span id="cb48-13"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> df_host_3,</span>
<span id="cb48-14"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> cont_n),</span>
<span id="cb48-15"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">4.5</span>,</span>
<span id="cb48-16"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">nudge_y =</span> <span class="fl">0.6</span>)<span class="sc">+</span></span>
<span id="cb48-17"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;History of hosting world cup&quot;</span>,</span>
<span id="cb48-18"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Number of hosted world cups and hosting countries per continents&quot;</span>,</span>
<span id="cb48-19"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> caption_cdc)<span class="sc">+</span></span>
<span id="cb48-20"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#define fill and colors of the bars</span></span>
<span id="cb48-21"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> conti_cols)<span class="sc">+</span></span>
<span id="cb48-22"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> conti_cols)<span class="sc">+</span></span>
<span id="cb48-23"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#define the theme</span></span>
<span id="cb48-24"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb48-25"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb48-26"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb48-27"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb48-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>()))</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-26-1.png" width="100%" height="100%" /></p>
<p>These long bars, there’s something about them. Something … empty. I got an idea! Why not fill them with the names of the hosting countries?! That would look awesome!</p>
<p>The goal is stack countries’ names in an equidistant fashion within each bar. To do this, we divide the bar, which indicates the number of hosted world cups, by the number of hosting countries. This would simply partition the bar into equally-sized parts equal to the number of hosting countries. Finally, to get the location of countries within the bar, we compute the cumulative sum of the size of these parts.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb49-1" aria-hidden="true" tabindex="-1"></a>df_txt_bar <span class="ot">&lt;-</span> df_host1 <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb49-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">group_by</span>(continent, country_name) <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb49-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">summarise</span>(<span class="at">n_host =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="co"># number of hosted world cups per country</span></span>
<span id="cb49-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb49-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span> </span>
<span id="cb49-5"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb49-5" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">n_countries =</span> <span class="fu">n</span>(), <span class="co">#number of hosting countries </span></span>
<span id="cb49-6"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb49-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">n_cont =</span> <span class="fu">sum</span>(n_host), <span class="co">#number of hosted world cups per continent (height of the bar)</span></span>
<span id="cb49-7"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb49-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prop =</span> n_cont<span class="sc">/</span>(n_countries<span class="sc">+</span><span class="dv">1</span>), <span class="co"># divides the bar height by the number of countries</span></span>
<span id="cb49-8"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb49-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">cum_prop =</span> <span class="fu">cumsum</span>(prop) <span class="co">#stack countries&#39; names within the bar</span></span>
<span id="cb49-9"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb49-9" aria-hidden="true" tabindex="-1"></a>                     )<span class="sc">%&gt;%</span></span>
<span id="cb49-10"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb49-10" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb49-11"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb49-11" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">country_name =</span> <span class="fu">ifelse</span>(n_host <span class="sc">&gt;</span><span class="dv">1</span> , glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;{country_name} x {n_host}&quot;</span>), country_name) <span class="co"># indicate the number of times a country hosted the world cup</span></span>
<span id="cb49-12"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb49-12" aria-hidden="true" tabindex="-1"></a>                     ) </span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;continent&#39;. You can override using the
## `.groups` argument.</code></pre>
<p>Let’s fill these empty bars with the names of the hosting countries</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb51-1" aria-hidden="true" tabindex="-1"></a>(bar_host_plt <span class="ot">&lt;-</span> bar_host_plt <span class="sc">+</span></span>
<span id="cb51-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb51-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_text</span>(<span class="at">data =</span> df_txt_bar,</span>
<span id="cb51-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb51-3" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">aes</span>(<span class="at">y =</span> cum_prop, <span class="at">label =</span> country_name),</span>
<span id="cb51-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb51-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">size =</span> <span class="dv">4</span></span>
<span id="cb51-5"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb51-5" aria-hidden="true" tabindex="-1"></a>                            ))</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-28-1.png" width="100%" height="100%" /></p>
<p>This looks really beautiful, but with some deficits. One can notice some names of co-hosting countries and continents that are “overflowing” outside their bar.</p>
<p>Let’s fix this by setting the boundaries of the each bar. First, let’s calculate the boundaries</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set the boundaries as 0.45 on each from the center of the bar</span></span>
<span id="cb52-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb52-2" aria-hidden="true" tabindex="-1"></a>df_txt_bar2 <span class="ot">&lt;-</span> df_txt_bar <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">continent =</span> <span class="fu">factor</span>(continent, <span class="at">levels =</span> <span class="fu">levels</span>(df_host2<span class="sc">$</span>continent)),</span>
<span id="cb52-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb52-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="fu">as.integer</span>(<span class="fu">as.factor</span>(continent)), <span class="co">#get the center of the bar</span></span>
<span id="cb52-5"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb52-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">xmin =</span> x<span class="fl">-0.45</span>, <span class="co">#lower bound</span></span>
<span id="cb52-6"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb52-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">xmax =</span> x<span class="fl">+0.45</span>) <span class="co">#upper bound</span></span></code></pre></div>
<p>… then apply them to the plot using <code>geom_fit_text</code> from ggfittext package</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-1" aria-hidden="true" tabindex="-1"></a>(bar_host_plt <span class="ot">&lt;-</span> df_host2 <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(continent, n))<span class="sc">+</span></span>
<span id="cb53-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">color =</span> continent), <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>,  <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb53-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> continent), <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb53-5"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#continent name</span></span>
<span id="cb53-6"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-6" aria-hidden="true" tabindex="-1"></a>  ggfittext<span class="sc">::</span><span class="fu">geom_fit_text</span>(<span class="at">data =</span> df_host_3 <span class="sc">%&gt;%</span></span>
<span id="cb53-7"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-7" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">as.integer</span>(<span class="fu">as.factor</span>(continent)),</span>
<span id="cb53-8"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">xmin =</span> x<span class="fl">-0.45</span>,</span>
<span id="cb53-9"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">xmax =</span> x<span class="fl">+0.45</span>),</span>
<span id="cb53-10"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-10" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">y =</span> n<span class="fl">+0.5</span>, <span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax, <span class="at">label =</span> cont_n),</span>
<span id="cb53-11"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size =</span><span class="dv">14</span></span>
<span id="cb53-12"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-12" aria-hidden="true" tabindex="-1"></a>                      )<span class="sc">+</span></span>
<span id="cb53-13"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Short countries&#39; names </span></span>
<span id="cb53-14"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_text</span>(<span class="at">data =</span> df_txt_bar[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">12</span>),],</span>
<span id="cb53-15"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-15" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">aes</span>(<span class="at">y =</span> cum_prop, <span class="at">label =</span> country_name),</span>
<span id="cb53-16"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-16" aria-hidden="true" tabindex="-1"></a>                            <span class="at">size =</span> <span class="dv">4</span></span>
<span id="cb53-17"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-17" aria-hidden="true" tabindex="-1"></a>                            )<span class="sc">+</span></span>
<span id="cb53-18"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Add &quot;Japan South Korea&quot; </span></span>
<span id="cb53-19"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-19" aria-hidden="true" tabindex="-1"></a>  ggfittext<span class="sc">::</span><span class="fu">geom_fit_text</span>(<span class="at">data =</span>df_txt_bar2[<span class="dv">2</span>,],</span>
<span id="cb53-20"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-20" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">aes</span>(<span class="at">y =</span> cum_prop,<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax, <span class="at">label =</span> country_name),</span>
<span id="cb53-21"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-21" aria-hidden="true" tabindex="-1"></a>                        <span class="at">size =</span> <span class="dv">14</span></span>
<span id="cb53-22"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-22" aria-hidden="true" tabindex="-1"></a>                        )<span class="sc">+</span></span>
<span id="cb53-23"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Add &quot;Canada, Mexico, United States&quot;</span></span>
<span id="cb53-24"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-24" aria-hidden="true" tabindex="-1"></a>  ggfittext<span class="sc">::</span><span class="fu">geom_fit_text</span>(<span class="at">data =</span>df_txt_bar2[<span class="dv">12</span>,],</span>
<span id="cb53-25"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-25" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">aes</span>(<span class="at">y =</span> cum_prop,<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax, <span class="at">label =</span> country_name),</span>
<span id="cb53-26"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-26" aria-hidden="true" tabindex="-1"></a>                        <span class="at">size =</span> <span class="dv">14</span></span>
<span id="cb53-27"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-27" aria-hidden="true" tabindex="-1"></a>                        )<span class="sc">+</span></span>
<span id="cb53-28"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;History of hosting world cup&quot;</span>,</span>
<span id="cb53-29"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Number of hosted world cups and hosting countries per continents&quot;</span>,</span>
<span id="cb53-30"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> caption_cdc)<span class="sc">+</span></span>
<span id="cb53-31"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> conti_cols)<span class="sc">+</span></span>
<span id="cb53-32"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> conti_cols)<span class="sc">+</span></span>
<span id="cb53-33"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb53-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_nothing</span>())</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-30-1.png" width="100%" height="100%" /></p>
<p>This worked nicely! I will finalize this plot by adding an image of world cup in the background! Yes, you can do this in R. I got the code for the function <code>trasparent</code> used below from an answer <a href="#https://stackoverflow.com/questions/60820565/is-there-a-way-to-add-an-alpha-value-within-geom-image-in-ggplot">here</a>.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#get image</span></span>
<span id="cb54-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb54-2" aria-hidden="true" tabindex="-1"></a>wc_img <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;images/wc12.png&quot;</span>)</span>
<span id="cb54-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co">#define function to control transparency and set to 0.2</span></span>
<span id="cb54-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb54-5" aria-hidden="true" tabindex="-1"></a>transparent <span class="ot">&lt;-</span> <span class="cf">function</span>(img) {</span>
<span id="cb54-6"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb54-6" aria-hidden="true" tabindex="-1"></a>  magick<span class="sc">::</span><span class="fu">image_fx</span>(img, <span class="at">expression =</span> <span class="st">&quot;0.2*a&quot;</span>, <span class="at">channel =</span> <span class="st">&quot;alpha&quot;</span>)</span>
<span id="cb54-7"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb54-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-8"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="co">#add the image in the background</span></span>
<span id="cb54-9"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb54-9" aria-hidden="true" tabindex="-1"></a>bar_host_plt<span class="sc">+</span></span>
<span id="cb54-10"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb54-10" aria-hidden="true" tabindex="-1"></a>  ggimage<span class="sc">::</span><span class="fu">geom_image</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">7.5</span>),</span>
<span id="cb54-11"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb54-11" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">aes</span>(x,y),</span>
<span id="cb54-12"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb54-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">image =</span> wc_img,<span class="at">image_fun =</span> transparent,</span>
<span id="cb54-13"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb54-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-31-1.png" width="100%" height="100%" /></p>
<p>Isn’t that nice?!</p>
<p><img src="https://media.giphy.com/media/UQsYRkg6DLbJ6eIrYV/giphy.gif" /></p>
<p>Let’s add some geographical-context to these results by throwing the data on the world map and see how it would look like.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#get map of the world</span></span>
<span id="cb55-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb55-2" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">scale =</span> <span class="st">&quot;medium&quot;</span>, <span class="at">returnclass =</span> <span class="st">&quot;sf&quot;</span>)</span>
<span id="cb55-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(world)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 63 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -70.06611 ymin: -18.01973 xmax: 74.89131 ymax: 60.40581
## CRS:           +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
##   scalerank      featurecla labelrank     sovereignt sov_a3 adm0_dif level
## 0         3 Admin-0 country         5    Netherlands    NL1        1     2
## 1         1 Admin-0 country         3    Afghanistan    AFG        0     2
## 2         1 Admin-0 country         3         Angola    AGO        0     2
## 3         1 Admin-0 country         6 United Kingdom    GB1        1     2
## 4         1 Admin-0 country         6        Albania    ALB        0     2
## 5         3 Admin-0 country         6        Finland    FI1        1     2
##                type       admin adm0_a3 geou_dif     geounit gu_a3 su_dif
## 0           Country       Aruba     ABW        0       Aruba   ABW      0
## 1 Sovereign country Afghanistan     AFG        0 Afghanistan   AFG      0
## 2 Sovereign country      Angola     AGO        0      Angola   AGO      0
## 3        Dependency    Anguilla     AIA        0    Anguilla   AIA      0
## 4 Sovereign country     Albania     ALB        0     Albania   ALB      0
## 5           Country       Aland     ALD        0       Aland   ALD      0
##       subunit su_a3 brk_diff        name     name_long brk_a3    brk_name
## 0       Aruba   ABW        0       Aruba         Aruba    ABW       Aruba
## 1 Afghanistan   AFG        0 Afghanistan   Afghanistan    AFG Afghanistan
## 2      Angola   AGO        0      Angola        Angola    AGO      Angola
## 3    Anguilla   AIA        0    Anguilla      Anguilla    AIA    Anguilla
## 4     Albania   ALB        0     Albania       Albania    ALB     Albania
## 5       Aland   ALD        0       Aland Aland Islands    ALD       Aland
##   brk_group abbrev postal                    formal_en formal_fr note_adm0
## 0      &lt;NA&gt;  Aruba     AW                        Aruba      &lt;NA&gt;     Neth.
## 1      &lt;NA&gt;   Afg.     AF Islamic State of Afghanistan      &lt;NA&gt;      &lt;NA&gt;
## 2      &lt;NA&gt;   Ang.     AO  People&#39;s Republic of Angola      &lt;NA&gt;      &lt;NA&gt;
## 3      &lt;NA&gt;   Ang.     AI                         &lt;NA&gt;      &lt;NA&gt;      U.K.
## 4      &lt;NA&gt;   Alb.     AL          Republic of Albania      &lt;NA&gt;      &lt;NA&gt;
## 5      &lt;NA&gt;  Aland     AI                Åland Islands      &lt;NA&gt;      Fin.
##   note_brk   name_sort name_alt mapcolor7 mapcolor8 mapcolor9 mapcolor13
## 0     &lt;NA&gt;       Aruba     &lt;NA&gt;         4         2         2          9
## 1     &lt;NA&gt; Afghanistan     &lt;NA&gt;         5         6         8          7
## 2     &lt;NA&gt;      Angola     &lt;NA&gt;         3         2         6          1
## 3     &lt;NA&gt;    Anguilla     &lt;NA&gt;         6         6         6          3
## 4     &lt;NA&gt;     Albania     &lt;NA&gt;         1         4         1          6
## 5     &lt;NA&gt;       Aland     &lt;NA&gt;         4         1         4          6
##    pop_est gdp_md_est pop_year lastcensus gdp_year                    economy
## 0   103065     2258.0       NA       2010       NA       6. Developing region
## 1 28400000    22270.0       NA       1979       NA  7. Least developed region
## 2 12799293   110300.0       NA       1970       NA  7. Least developed region
## 3    14436      108.9       NA         NA       NA       6. Developing region
## 4  3639453    21810.0       NA       2001       NA       6. Developing region
## 5    27153     1563.0       NA         NA       NA 2. Developed region: nonG7
##                income_grp wikipedia fips_10 iso_a2 iso_a3 iso_n3 un_a3 wb_a2
## 0 2. High income: nonOECD        NA    &lt;NA&gt;     AW    ABW    533   533    AW
## 1           5. Low income        NA    &lt;NA&gt;     AF    AFG    004   004    AF
## 2  3. Upper middle income        NA    &lt;NA&gt;     AO    AGO    024   024    AO
## 3  3. Upper middle income        NA    &lt;NA&gt;     AI    AIA    660   660  &lt;NA&gt;
## 4  4. Lower middle income        NA    &lt;NA&gt;     AL    ALB    008   008    AL
## 5    1. High income: OECD        NA    &lt;NA&gt;     AX    ALA    248   248  &lt;NA&gt;
##   wb_a3 woe_id adm0_a3_is adm0_a3_us adm0_a3_un adm0_a3_wb     continent
## 0   ABW     NA        ABW        ABW         NA         NA North America
## 1   AFG     NA        AFG        AFG         NA         NA          Asia
## 2   AGO     NA        AGO        AGO         NA         NA        Africa
## 3  &lt;NA&gt;     NA        AIA        AIA         NA         NA North America
## 4   ALB     NA        ALB        ALB         NA         NA        Europe
## 5  &lt;NA&gt;     NA        ALA        ALD         NA         NA        Europe
##   region_un       subregion                 region_wb name_len long_len
## 0  Americas       Caribbean Latin America &amp; Caribbean        5        5
## 1      Asia   Southern Asia                South Asia       11       11
## 2    Africa   Middle Africa        Sub-Saharan Africa        6        6
## 3  Americas       Caribbean Latin America &amp; Caribbean        8        8
## 4    Europe Southern Europe     Europe &amp; Central Asia        7        7
## 5    Europe Northern Europe     Europe &amp; Central Asia        5       13
##   abbrev_len tiny homepart                       geometry
## 0          5    4       NA MULTIPOLYGON (((-69.89912 1...
## 1          4   NA        1 MULTIPOLYGON (((74.89131 37...
## 2          4   NA        1 MULTIPOLYGON (((14.19082 -5...
## 3          4   NA       NA MULTIPOLYGON (((-63.00122 1...
## 4          4   NA        1 MULTIPOLYGON (((20.06396 42...
## 5          5    5       NA MULTIPOLYGON (((20.61133 60...</code></pre>
<p>Additionally we’ll retreive the country code as we’ll need it later.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb57-1" aria-hidden="true" tabindex="-1"></a>host_iso2 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(<span class="fu">unique</span>(tbls_lst<span class="sc">$</span>list_of_hosts<span class="sc">$</span>country_code))</span>
<span id="cb57-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb57-2" aria-hidden="true" tabindex="-1"></a>wcp_hosts <span class="ot">&lt;-</span> <span class="fu">gisco_get_countries</span>(<span class="at">country =</span> host_iso2,</span>
<span id="cb57-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb57-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">epsg =</span> <span class="dv">3857</span><span class="co"># Pseudo-Mercator projection</span></span>
<span id="cb57-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb57-4" aria-hidden="true" tabindex="-1"></a>                                 )</span>
<span id="cb57-5"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb57-5" aria-hidden="true" tabindex="-1"></a>wcp_hosts<span class="sc">$</span>iso2 <span class="ot">&lt;-</span> host_iso2</span></code></pre></div>
<p>Let’s plot a basic map of the world using ggplot.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base map of the world</span></span>
<span id="cb58-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb58-2" aria-hidden="true" tabindex="-1"></a>(plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(world) <span class="sc">+</span></span>
<span id="cb58-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">fill =</span> <span class="st">&quot;grey90&quot;</span>) <span class="sc">+</span></span>
<span id="cb58-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_nothing</span>() <span class="sc">+</span></span>
<span id="cb58-5"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>)))</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-34-1.png" width="100%" height="100%" /></p>
<p>Cool! Finally, let’s make the map extra flashy by filling hosting countries with their maps.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get flags form this repo</span></span>
<span id="cb59-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb59-2" aria-hidden="true" tabindex="-1"></a>flagrepo <span class="ot">&lt;-</span> <span class="st">&quot;https://raw.githubusercontent.com/hjnilsson/country-flags/master/png250px/&quot;</span></span></code></pre></div>
<p>Finally, we’ll download the flags</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop and add</span></span>
<span id="cb60-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (iso <span class="cf">in</span> host_iso2) {</span>
<span id="cb60-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Download pic and plot</span></span>
<span id="cb60-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb60-4" aria-hidden="true" tabindex="-1"></a>  imgurl <span class="ot">&lt;-</span> <span class="fu">paste0</span>(flagrepo, <span class="fu">tolower</span>(iso), <span class="st">&quot;.png&quot;</span>)</span>
<span id="cb60-5"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb60-5" aria-hidden="true" tabindex="-1"></a>  tmpfile <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">&quot;.png&quot;</span>)</span>
<span id="cb60-6"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(imgurl, tmpfile, <span class="at">quiet =</span> <span class="cn">TRUE</span>, <span class="at">mode =</span> <span class="st">&quot;wb&quot;</span>)</span>
<span id="cb60-7"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb60-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-8"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Raster</span></span>
<span id="cb60-9"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb60-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> wcp_hosts <span class="sc">%&gt;%</span> <span class="fu">filter</span>(iso2 <span class="sc">==</span> iso)</span>
<span id="cb60-10"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb60-10" aria-hidden="true" tabindex="-1"></a>  x_rast <span class="ot">&lt;-</span> <span class="fu">rasterpic_img</span>(x, tmpfile, <span class="at">crop =</span> <span class="cn">TRUE</span>, <span class="at">mask =</span> <span class="cn">TRUE</span>)</span>
<span id="cb60-11"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb60-11" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> plot <span class="sc">+</span> <span class="fu">layer_spatial</span>(x_rast)</span>
<span id="cb60-12"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb60-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>and add them to world map</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb61-1" aria-hidden="true" tabindex="-1"></a>plot <span class="sc">+</span></span>
<span id="cb61-2"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> wcp_hosts, <span class="at">fill =</span> <span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb61-3"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;World map of FIFA world cup hosts&quot;</span>,</span>
<span id="cb61-4"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb61-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Number of hosted world cups and hosting countries per continents&quot;</span>,</span>
<span id="cb61-5"><a href="how-many-world-cups-were-hosted-in-each-continent.html#cb61-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> caption_cdc)</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-37-1.png" width="100%" height="100%" /></p>
<p>I’m very happy with the end result!</p>
<p><img src="https://media.giphy.com/media/jdBJkDYMphKaf89OTl/giphy.gif" /><br />
</p>
<p>Have a look at this <a href="https://dieghernan.github.io/202201_maps-flags/">excellent blog</a> for more details on adding flags to maps This is where I got to know and learn this trick.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="where-and-how-can-we-get-the-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="what-is-the-timeline-of-hosting-the-world-cup.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Cairo-Data-Science-Club-CDC/Fifa-worldcup-2022/edit/main/01-hosting_history.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
