<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.4 What is the history of bidding for world cup? | Fifa worldcup 2022</title>
  <meta name="description" content="2.4 What is the history of bidding for world cup? | Fifa worldcup 2022" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="2.4 What is the history of bidding for world cup? | Fifa worldcup 2022" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.4 What is the history of bidding for world cup? | Fifa worldcup 2022" />
  
  
  

<meta name="author" content="Mohamed R.Shoeb" />


<meta name="date" content="2022-12-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="what-is-the-timeline-of-hosting-the-world-cup.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Fifa worldcup 2022</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> FIFA world cup 2022 Challenge!</a></li>
<li class="chapter" data-level="2" data-path="history-of-hosting-fifa-world-cup.html"><a href="history-of-hosting-fifa-world-cup.html"><i class="fa fa-check"></i><b>2</b> History of hosting FIFA World Cup</a>
<ul>
<li class="chapter" data-level="2.1" data-path="where-and-how-can-we-get-the-data.html"><a href="where-and-how-can-we-get-the-data.html"><i class="fa fa-check"></i><b>2.1</b> Where and how can we get the data?</a></li>
<li class="chapter" data-level="2.2" data-path="how-many-world-cups-were-hosted-in-each-continent.html"><a href="how-many-world-cups-were-hosted-in-each-continent.html"><i class="fa fa-check"></i><b>2.2</b> How many world cups were hosted in each continent?</a></li>
<li class="chapter" data-level="2.3" data-path="what-is-the-timeline-of-hosting-the-world-cup.html"><a href="what-is-the-timeline-of-hosting-the-world-cup.html"><i class="fa fa-check"></i><b>2.3</b> What is the timeline of hosting the world cup?</a></li>
<li class="chapter" data-level="2.4" data-path="what-is-the-history-of-bidding-for-world-cup.html"><a href="what-is-the-history-of-bidding-for-world-cup.html"><i class="fa fa-check"></i><b>2.4</b> What is the history of bidding for world cup?</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fifa worldcup 2022</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="what-is-the-history-of-bidding-for-world-cup" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> What is the history of bidding for world cup?<a href="what-is-the-history-of-bidding-for-world-cup.html#what-is-the-history-of-bidding-for-world-cup" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now let us shift our focus to yet another interesting question. In this section we will explore the bidding history to host the world cup.</p>
<p>Let’s start by making a bar-plot that show the number of successful bids for each country of all submitted bids.</p>
<p>First, sort the countries based on the number of bids, then the times hosted.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb24-1" aria-hidden="true" tabindex="-1"></a>(bar_bid_df1 <span class="ot">&lt;-</span> tbls_lst<span class="sc">$</span>total_bids_by_country <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(bids,times_hosted) <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">factor</span>(country, <span class="at">levels =</span> (country))) )</span></code></pre></div>
<pre><code>## # A tibble: 35 × 4
##    country   bids years   times_hosted
##    &lt;fct&gt;    &lt;int&gt; &lt;chr&gt;          &lt;dbl&gt;
##  1 Austria      1 1990               0
##  2 Belgium      1 2018[f]            0
##  3 Egypt        1 2010               0
##  4 Greece       1 1990               0
##  5 Hungary      1 1930               0
##  6 Iran         1 1990               0
##  7 Libya        1 2010[h]            0
##  8 Nigeria      1 2010               0
##  9 Peru         1 1970               0
## 10 Portugal     1 2018[d]            0
## # … with 25 more rows</code></pre>
<p>Next, add a layer of bars showing the times of bids using a transparent color</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb26-1" aria-hidden="true" tabindex="-1"></a>(bar_bid_plt <span class="ot">&lt;-</span> bar_bid_df1 <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb26-3"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(country,bids), <span class="at">fill =</span> <span class="st">&quot;#35978f&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>))</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-21-1.png" width="100%" height="100%" /></p>
<p>Then, add yet another layer of bars showing the times hosted using solid version of the same color</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb27-1" aria-hidden="true" tabindex="-1"></a>(bar_bid_plt <span class="ot">&lt;-</span>bar_bid_plt <span class="sc">+</span></span>
<span id="cb27-2"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(country,times_hosted), <span class="at">fill =</span> <span class="st">&quot;#35978f&quot;</span>, <span class="at">alpha =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb27-3"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>())</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-22-1.png" width="100%" height="100%" /></p>
<p>Finally, add text and customize the theme</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb28-1" aria-hidden="true" tabindex="-1"></a>(bar_bid_plt <span class="sc">+</span></span>
<span id="cb28-2"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;History of hosting FIFA world cup&quot;</span>,</span>
<span id="cb28-3"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb28-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">subtitle =</span> <span class="st">&quot;Number of world cup bids compared to times hosted&quot;</span>,</span>
<span id="cb28-4"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb28-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">caption =</span> caption_cdc,</span>
<span id="cb28-5"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb28-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Numer of bids&quot;</span>)<span class="sc">+</span></span>
<span id="cb28-6"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb28-7"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb28-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">7.6</span>),</span>
<span id="cb28-8"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb28-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span>  <span class="st">&quot;#FAECD6&quot;</span>),</span>
<span id="cb28-9"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb28-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span>  <span class="st">&quot;#FAECD6&quot;</span>),</span>
<span id="cb28-10"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb28-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;#01665e&quot;</span>, <span class="at">size =</span> <span class="dv">9</span>)))</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-23-1.png" width="100%" height="100%" /></p>
<p>Nice! The plot shows that most of the time, it takes more than one bid to host the world cup.</p>
<p><img src="https://media.giphy.com/media/mxCK3EcADG1F7krLP6/giphy.gif" /></p>
<p>Let’s enforce the relationship between bids and times hosted using a point plot.</p>
<p>First, let’s plot the number of bids on the x-axis and the time hosted on the y-axis</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb29-1" aria-hidden="true" tabindex="-1"></a>(point_bid_plt <span class="ot">&lt;-</span> tbls_lst<span class="sc">$</span>total_bids_by_country <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(bids, times_hosted))<span class="sc">+</span></span>
<span id="cb29-3"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;#35978f&quot;</span>))</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-24-1.png" width="100%" height="100%" /></p>
<p>Next, let’s add the name of the country to the repreresentitive point</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb30-1" aria-hidden="true" tabindex="-1"></a>(point_bid_plt <span class="ot">&lt;-</span> point_bid_plt<span class="sc">+</span></span>
<span id="cb30-2"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> country),</span>
<span id="cb30-3"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb30-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">4</span>))</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-25-1.png" width="100%" height="100%" /></p>
<p>Oh no! Since many countries share the same bids and hosting statitics, we end up with a dramatic case of text over-plotting.</p>
<p><img src="https://i.gifer.com/3esj.gif" /></p>
<p>To overcome this, we’ll replace <code>geom_text()</code> with <code>geom_text_repel()</code> from the package <code>ggrepel</code>. Let’s first look at the effect of this function and then explain what it does.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#remove the last layer added of geom_text() before using geom_text_repel()</span></span>
<span id="cb31-2"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb31-2" aria-hidden="true" tabindex="-1"></a>point_bid_plt<span class="sc">$</span>layers[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb31-3"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb31-3" aria-hidden="true" tabindex="-1"></a>(point_bid_plt <span class="ot">&lt;-</span> point_bid_plt<span class="sc">+</span></span>
<span id="cb31-4"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb31-4" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> country),</span>
<span id="cb31-5"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb31-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb31-6"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb31-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">min.segment.length =</span> <span class="dv">0</span>,</span>
<span id="cb31-7"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb31-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">max.overlaps =</span> <span class="cn">Inf</span>,</span>
<span id="cb31-8"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb31-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">segment.color=</span><span class="st">&quot;grey60&quot;</span>,</span>
<span id="cb31-9"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb31-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">box.padding =</span> <span class="fl">0.4</span></span>
<span id="cb31-10"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb31-10" aria-hidden="true" tabindex="-1"></a>                            )<span class="sc">+</span></span>
<span id="cb31-11"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#expand the plotting panel to free some room for the repelled text</span></span>
<span id="cb31-12"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,</span>
<span id="cb31-13"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb31-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>)))<span class="sc">+</span></span>
<span id="cb31-14"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb31-15"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb31-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>))))</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-26-1.png" width="100%" height="100%" /></p>
<p>As the name says, <code>geom_text_repel()</code> makes the text repel away from each other to avoid over-plotting. The text also repel away from the edges of the plot. To avoid the undesired effect of later, we expanded the plotting are using the function <code>expansion()</code> in x and y direction</p>
<p>Finally, add the title and beautify the plot by coloring the background</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb32-1" aria-hidden="true" tabindex="-1"></a>(point_bid_plt <span class="ot">&lt;-</span> point_bid_plt<span class="sc">+</span></span>
<span id="cb32-2"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;History of hosting FIFA world cup&quot;</span>,</span>
<span id="cb32-3"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb32-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Number of world cup bids compared to times hosted&quot;</span>,</span>
<span id="cb32-4"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb32-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> caption_cdc,</span>
<span id="cb32-5"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb32-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Numer of bids&quot;</span>,</span>
<span id="cb32-6"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb32-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Number of times hosted&quot;</span>)<span class="sc">+</span></span>
<span id="cb32-7"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span>  <span class="st">&quot;#FAECD6&quot;</span>),</span>
<span id="cb32-8"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb32-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span>  <span class="st">&quot;#FAECD6&quot;</span>),</span>
<span id="cb32-9"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb32-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb32-10"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb32-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;#01665e&quot;</span>)))</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-27-1.png" width="100%" height="100%" /></p>
<p>It’s now clear that Germany has the lion’s share of submitted bids, while Morocco is obviously lacks a bit of luck!</p>
<p>What’s missing from the plots above is the time where bids and hosting took place. Wouldn’t it be interesting to have a single plot showing the number and dates of world cup bids? I would say YES!</p>
<p><img src="https://media.giphy.com/media/h1oqRd3zec0MrP34Xc/giphy.gif" /></p>
<p>Let’s work towards building this exciting plot! Firs, what we need to do is to split years of bids into separate entries.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#separate concatenated years into separate rows</span></span>
<span id="cb33-2"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb33-2" aria-hidden="true" tabindex="-1"></a>df_bids <span class="ot">&lt;-</span> tbls_lst<span class="sc">$</span>total_bids_by_country <span class="sc">%&gt;%</span> </span>
<span id="cb33-3"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">years =</span> <span class="fu">str_extract_all</span>(years, <span class="st">&quot;[0-9]+&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-4"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(years) <span class="sc">%&gt;%</span> </span>
<span id="cb33-5"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">years =</span> <span class="fu">as.numeric</span>(years))</span>
<span id="cb33-6"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co">#another way to achieve the same results using seprata_rows() and enginered regular expression</span></span>
<span id="cb33-7"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb33-7" aria-hidden="true" tabindex="-1"></a>df_bids_2 <span class="ot">&lt;-</span> tbls_lst<span class="sc">$</span>total_bids_by_country <span class="sc">%&gt;%</span> </span>
<span id="cb33-8"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(years, <span class="at">sep =</span> <span class="st">&quot;[^[:digit:].]+&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-9"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">nchar</span>( years)<span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-10"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">years =</span> <span class="fu">as.numeric</span>(years)) </span>
<span id="cb33-11"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Are both tables equal?</span></span>
<span id="cb33-12"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb33-12" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">all_equal</span>(df_bids, df_bids_2)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(df_bids_2)</span></code></pre></div>
<p>Will then do a similar thing by spliting cohosts of the same world cup (e.g. “Japan South Korea”) into separate rows entries (“Japan”, “South Korea”).</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#separate cohosting countries into separate entries</span></span>
<span id="cb36-2"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb36-2" aria-hidden="true" tabindex="-1"></a>df_host_2 <span class="ot">&lt;-</span> df_host1 <span class="sc">%&gt;%</span> </span>
<span id="cb36-3"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">host_nation_s =</span> <span class="fu">str_split</span>(host_nation_s, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">s{2}&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(host_nation_s) <span class="sc">%&gt;%</span> </span>
<span id="cb36-5"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb36-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">country=</span><span class="st">&quot;host_nation_s&quot;</span>,</span>
<span id="cb36-6"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb36-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">host_year =</span> <span class="st">&quot;year&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-7"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(df_bids, <span class="at">by =</span> <span class="st">&quot;country&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-8"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">host_year =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(continent), years, host_year)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-9"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(bids) <span class="sc">%&gt;%</span> </span>
<span id="cb36-10"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">factor</span>(country, <span class="at">levels =</span> <span class="fu">unique</span>(country)),</span>
<span id="cb36-11"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb36-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">bids =</span> <span class="fu">factor</span>(bids, <span class="at">levels =</span> <span class="fu">sort</span>(<span class="fu">unique</span>(bids), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
<p>The data is ready for visual inspection! The idea is to look on the data in the form of a tile plot showing the year on the x axis and country on the y axis. Bids will be represented using faint colored boxes.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb37-1" aria-hidden="true" tabindex="-1"></a>(tile_bid_host_plt <span class="ot">&lt;-</span> df_host_2 <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb37-3"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(years, country),</span>
<span id="cb37-4"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb37-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">&quot;#c7eae5&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>) )</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-30-1.png" width="100%" height="100%" /></p>
<p>Next, add another layer of tiles with solid color showing the years of hosting the world cup.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#select data with at least one time hosting</span></span>
<span id="cb38-2"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb38-2" aria-hidden="true" tabindex="-1"></a>df_host_3 <span class="ot">&lt;-</span> df_host_2 <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb38-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(times_hosted<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> host_year <span class="sc">==</span> years)</span>
<span id="cb38-4"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb38-4" aria-hidden="true" tabindex="-1"></a>(tile_bid_host_plt <span class="ot">&lt;-</span> tile_bid_host_plt <span class="sc">+</span></span>
<span id="cb38-5"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data =</span> df_host_3,</span>
<span id="cb38-6"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb38-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(years, country),</span>
<span id="cb38-7"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb38-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill=</span><span class="st">&quot;#35978f&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-31-1.png" width="100%" height="100%" /></p>
<p>Whether you’re a football fan or have an observant eye, it’s not difficult to tell that there are gap years in the plot in which the world cup was cancelled. Let’s highlight this part of the plot to, first, give a complete picture of the history of hosting the championship and , second, to make itclear that it’s not a case of missing data.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb39-1" aria-hidden="true" tabindex="-1"></a>(tile_bid_host_plt <span class="ot">&lt;-</span> tile_bid_host_plt <span class="sc">+</span></span>
<span id="cb39-2"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#add a transparent rectangle between 1942 and 1946</span></span>
<span id="cb39-3"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">xmin =</span> <span class="dv">1942</span>, <span class="at">xmax =</span> <span class="dv">1946</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>),</span>
<span id="cb39-4"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb39-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax, <span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax), </span>
<span id="cb39-5"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb39-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.05</span>,</span>
<span id="cb39-6"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb39-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb39-7"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb39-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb39-8"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb39-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">0.1</span>,</span>
<span id="cb39-9"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb39-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb39-10"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#overlay an explanation on top the rectangle</span></span>
<span id="cb39-11"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb39-12"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb39-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">x =</span> <span class="dv">1944</span>, <span class="at">y =</span> <span class="fl">17.5</span>,<span class="at">size =</span> <span class="fl">2.5</span>,<span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb39-13"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb39-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;World Cups of 1942 and 1946 were both cancelled because of WW2&quot;</span>)<span class="sc">+</span></span>
<span id="cb39-14"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#represet years on the x axis with 4 year interval between 1930 and 2026</span></span>
<span id="cb39-15"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1930</span>, <span class="dv">2026</span>,<span class="dv">4</span>)))</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-32-1.png" width="100%" height="100%" /></p>
<p>Let’s finish by adding the title and removing the y axis</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb40-1" aria-hidden="true" tabindex="-1"></a>(tile_bid_host_plt <span class="ot">&lt;-</span> tile_bid_host_plt <span class="sc">+</span></span>
<span id="cb40-2"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;History of hosting FIFA world cup&quot;</span>,</span>
<span id="cb40-3"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb40-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Timeline of bidding (faint boxes;no outline) and hosting (dark boxes;black outline) countries of FIFA world cup&quot;</span>,</span>
<span id="cb40-4"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb40-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> caption_cdc)<span class="sc">+</span></span>
<span id="cb40-5"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb40-6"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb40-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">45</span>,<span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb40-7"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb40-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb40-8"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb40-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb40-9"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb40-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb40-10"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb40-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">7.6</span>),</span>
<span id="cb40-11"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb40-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;grey80&quot;</span>),</span>
<span id="cb40-12"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb40-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()))</span></code></pre></div>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-33-1.png" width="100%" height="100%" /></p>
<p>This a comprehensive, yet clear, visualization of bidding and hosting the world cup! We can simultaneously make interesting observations about the years (e.g. 1990 and 2019 received the largest number of bids!) and the history of the hosting countries (e.g. 2026 will be the first world cup to be hosted by three countries!).</p>
<p><img src="https://media.giphy.com/media/KfJAmevRamCTGUkKUd/giphy.gif" /></p>
<p>Let’s take this plot to the next level and augment it with the results of the hosting country. Furthermore, as a cherry on top, will add respective flag of each country. To start with, we’ll get the country code that would allow us to find a country’s flag.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#get iso2 code of each country (flags for Yugoslavia and England are missing)</span></span>
<span id="cb41-2"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb41-2" aria-hidden="true" tabindex="-1"></a>df_host_2<span class="sc">$</span>iso2 <span class="ot">&lt;-</span> <span class="fu">countrycode</span>(df_host_2<span class="sc">$</span>country, <span class="st">&quot;country.name&quot;</span>, <span class="st">&quot;iso2c&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in countrycode_convert(sourcevar = sourcevar, origin = origin, destination = dest, : Some values were not matched unambiguously: Yugoslavia, England</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#colors of the different results (First place, runner up, third place, ... etc)</span></span>
<span id="cb43-2"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb43-2" aria-hidden="true" tabindex="-1"></a>res_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#FFD700&quot;</span>,</span>
<span id="cb43-3"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb43-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;#d9d9d9&quot;</span>,</span>
<span id="cb43-4"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb43-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;#CD7F32&quot;</span>,</span>
<span id="cb43-5"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb43-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;#f6e8c3&quot;</span>,</span>
<span id="cb43-6"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb43-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;#969696&quot;</span>,</span>
<span id="cb43-7"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb43-7" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;#737373&quot;</span>,</span>
<span id="cb43-8"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb43-8" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;#525252&quot;</span>,</span>
<span id="cb43-9"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb43-9" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;#000000&quot;</span></span>
<span id="cb43-10"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb43-10" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb43-11"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(res_cols) <span class="ot">&lt;-</span> results_order[<span class="sc">-</span><span class="fu">length</span>(results_order )]</span></code></pre></div>
<p>Already tired? We’re almost there!</p>
<p><img src="https://media.giphy.com/media/J6J2RvOQLTiXI3yWKH/giphy.gif" /></p>
<p>Let’s piece everything together for one last time.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-1" aria-hidden="true" tabindex="-1"></a>df_host_2 <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb44-3"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#tiles for bidding</span></span>
<span id="cb44-4"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(years, country),</span>
<span id="cb44-5"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">&quot;grey85&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb44-6"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#over-plot tiles of the results</span></span>
<span id="cb44-7"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data =</span> tbls_lst<span class="sc">$</span>host_country_performances <span class="sc">%&gt;%</span></span>
<span id="cb44-8"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-8" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(result <span class="sc">!=</span> <span class="st">&quot;TBD&quot;</span>) ,</span>
<span id="cb44-9"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(years, country, <span class="at">fill =</span> result),</span>
<span id="cb44-10"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb44-11"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#add country flag</span></span>
<span id="cb44-12"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-12" aria-hidden="true" tabindex="-1"></a>  ggimage<span class="sc">::</span><span class="fu">geom_flag</span>(<span class="at">data =</span> df_host_2 <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(country,iso2),</span>
<span id="cb44-13"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> country, <span class="at">image=</span>iso2),</span>
<span id="cb44-14"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="dv">1925</span>,</span>
<span id="cb44-15"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span><span class="fl">0.03</span>)<span class="sc">+</span></span>
<span id="cb44-16"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#add results colors</span></span>
<span id="cb44-17"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> res_cols)<span class="sc">+</span></span>
<span id="cb44-18"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#define the years intervals shown on the x axis and expand left side for the flags</span></span>
<span id="cb44-19"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1930</span>, <span class="dv">2026</span>,<span class="dv">4</span>),</span>
<span id="cb44-20"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="cn">NA</span>)))<span class="sc">+</span></span>
<span id="cb44-21"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#add rectangle to highlight cancelled years</span></span>
<span id="cb44-22"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">xmin =</span> <span class="dv">1942</span>, <span class="at">xmax =</span> <span class="dv">1946</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>),</span>
<span id="cb44-23"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax, <span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax), </span>
<span id="cb44-24"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.05</span>,</span>
<span id="cb44-25"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb44-26"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb44-27"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">0.1</span>,</span>
<span id="cb44-28"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb44-29"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Annotate the rectangle</span></span>
<span id="cb44-30"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb44-31"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">x =</span> <span class="dv">1944</span>, <span class="at">y =</span> <span class="fl">17.5</span>,<span class="at">size =</span> <span class="fl">2.5</span>,<span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb44-32"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;World Cups of 1942 and 1946 were both cancelled because of WW2&quot;</span>)<span class="sc">+</span></span>
<span id="cb44-33"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#define title and subtitle</span></span>
<span id="cb44-34"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;History of hosting FIFA world cup&quot;</span>,</span>
<span id="cb44-35"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Timeline of bidding (faint boxes;no outline) and hosting (dark boxes;black outline) countries of FIFA world cup&quot;</span>,</span>
<span id="cb44-36"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> caption_cdc)<span class="sc">+</span></span>
<span id="cb44-37"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-37" aria-hidden="true" tabindex="-1"></a>  <span class="co">#control the order and size of the legend keys</span></span>
<span id="cb44-38"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb44-39"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-39" aria-hidden="true" tabindex="-1"></a>                             <span class="at">keywidth =</span> <span class="fl">0.85</span>, </span>
<span id="cb44-40"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-40" aria-hidden="true" tabindex="-1"></a>                             <span class="at">keyheight =</span> <span class="fl">0.25</span>))<span class="sc">+</span></span>
<span id="cb44-41"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb44-42"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">45</span>,<span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb44-43"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb44-44"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb44-45"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb44-46"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">7.6</span>),</span>
<span id="cb44-47"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;grey80&quot;</span>),</span>
<span id="cb44-48"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb44-49"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb44-50"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">6.9</span>),</span>
<span id="cb44-51"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.x =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>,<span class="st">&quot;cm&quot;</span> ),</span>
<span id="cb44-52"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span></span>
<span id="cb44-53"><a href="what-is-the-history-of-bidding-for-world-cup.html#cb44-53" aria-hidden="true" tabindex="-1"></a>        )</span></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (`geom_image()`).</code></pre>
<p><img src="01-hosting_history_files/figure-html/unnamed-chunk-35-1.png" width="100%" height="100%" /></p>
<p>WOW! We’ve managed to summarize the history of world cup in a single plot!</p>
<p>Mission accomplished!</p>
<p><img src="https://media.giphy.com/media/WZTgoOuIs63QEV8IFn/giphy.gif" /></p>

</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="what-is-the-timeline-of-hosting-the-world-cup.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Cairo-Data-Science-Club-CDC/Fifa-worldcup-2022/edit/main/01-hosting_history.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
